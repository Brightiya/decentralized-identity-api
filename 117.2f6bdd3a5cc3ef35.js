"use strict";(self.webpackChunkangular_src=self.webpackChunkangular_src||[]).push([[117],{1117:(A,u,i)=>{i.r(u),i.d(u,{ProfileEditComponent:()=>B});var e=i(4292),m=i(9351),a=i(7199),_=i(8598),c=i(1764),g=i(3505),b=i(4536),p=i(5320),v=i(91),h=i(8497),k=i(4910),P=i(6093),E=i(5904),x=i(2927),C=i(3501),O=i(3636),M=i(3862),F=i(7694);function y(o,l){1&o&&(e.j41(0,"div",6),e.nrm(1,"mat-spinner",7),e.j41(2,"div",8)(3,"h3"),e.EFF(4,"Waiting for wallet"),e.k0s(),e.j41(5,"p",9),e.EFF(6,"Connect your wallet to edit your profile"),e.k0s()()())}function j(o,l){if(1&o&&(e.j41(0,"mat-option",30),e.EFF(1),e.k0s()),2&o){const n=l.$implicit;e.Y8G("value",n.value),e.R7$(),e.SpI(" ",n.label," ")}}function D(o,l){if(1&o){const n=e.RV6();e.j41(0,"div",31)(1,"mat-form-field",32)(2,"mat-label"),e.EFF(3,"Platform"),e.k0s(),e.nrm(4,"input",33),e.k0s(),e.j41(5,"mat-form-field",34)(6,"mat-label"),e.EFF(7,"URL"),e.k0s(),e.nrm(8,"input",35),e.j41(9,"mat-icon",36),e.EFF(10,"link"),e.k0s()(),e.j41(11,"button",37),e.bIt("click",function(){const r=e.eBV(n).index,d=e.XpG(2);return e.Njj(d.removeLink(r))}),e.j41(12,"mat-icon"),e.EFF(13,"delete_outline"),e.k0s()()()}2&o&&e.Y8G("formGroupName",l.index)}function T(o,l){1&o&&(e.j41(0,"div",38)(1,"mat-icon",39),e.EFF(2,"link_off"),e.k0s(),e.j41(3,"p"),e.EFF(4,"No links added yet"),e.k0s()())}function I(o,l){1&o&&(e.j41(0,"mat-icon"),e.EFF(1,"save"),e.k0s())}function R(o,l){1&o&&(e.j41(0,"span"),e.EFF(1,"Save Profile"),e.k0s())}function w(o,l){1&o&&e.nrm(0,"mat-spinner",40)}function L(o,l){if(1&o){const n=e.RV6();e.qex(0),e.j41(1,"form",10),e.bIt("ngSubmit",function(){e.eBV(n);const r=e.XpG();return e.Njj(r.onSubmit())}),e.j41(2,"div",11)(3,"mat-form-field",12)(4,"mat-label"),e.EFF(5,"Gender"),e.k0s(),e.j41(6,"mat-select",13)(7,"mat-option",14),e.EFF(8,"Prefer not to say"),e.k0s(),e.DNE(9,j,2,2,"mat-option",15),e.k0s(),e.j41(10,"mat-hint"),e.EFF(11,"Optional \u2022 Private by default"),e.k0s()(),e.j41(12,"mat-form-field",12)(13,"mat-label"),e.EFF(14,"Pronouns"),e.k0s(),e.nrm(15,"input",16),e.j41(16,"mat-hint"),e.EFF(17,"Free text \u2022 Visible to others"),e.k0s()(),e.j41(18,"mat-form-field",17)(19,"mat-label"),e.EFF(20,"Bio / About me"),e.k0s(),e.nrm(21,"textarea",18),e.j41(22,"mat-hint",19),e.EFF(23),e.k0s()()(),e.j41(24,"div",20)(25,"div",21)(26,"h3"),e.EFF(27,"Online Presence"),e.k0s(),e.j41(28,"button",22),e.bIt("click",function(){e.eBV(n);const r=e.XpG();return e.Njj(r.addLink())}),e.j41(29,"mat-icon"),e.EFF(30,"add"),e.k0s()()(),e.j41(31,"div",23),e.DNE(32,D,14,1,"div",24),e.k0s(),e.DNE(33,T,5,0,"div",25),e.k0s(),e.j41(34,"div",26)(35,"button",27),e.DNE(36,I,2,0,"mat-icon",5)(37,R,2,0,"span",5)(38,w,1,0,"mat-spinner",28),e.k0s(),e.j41(39,"button",29),e.bIt("click",function(){e.eBV(n);const r=e.XpG();return e.Njj(r.cancel())}),e.EFF(40," Cancel "),e.k0s()()(),e.bVm()}if(2&o){let n;const t=e.XpG();e.R7$(),e.Y8G("formGroup",t.profileForm),e.R7$(8),e.Y8G("ngForOf",t.genderOptions),e.R7$(14),e.SpI(" ",(null==(n=t.profileForm.get("bio"))||null==n.value?null:n.value.length)||0,"/500 "),e.R7$(9),e.Y8G("ngForOf",t.onlineLinks.controls),e.R7$(),e.Y8G("ngIf",0===t.onlineLinks.length),e.R7$(2),e.Y8G("disabled",t.profileForm.invalid||t.saving()),e.R7$(),e.Y8G("ngIf",!t.saving()),e.R7$(),e.Y8G("ngIf",!t.saving()),e.R7$(),e.Y8G("ngIf",t.saving())}}let B=(()=>{class o{fb=(0,e.WQX)(a.ok);apiService=(0,e.WQX)(O.G);wallet=(0,e.WQX)(M.F);snackBar=(0,e.WQX)(k.UG);themeService=(0,e.WQX)(C.F);router=(0,e.WQX)(E.Ix);activatedRoute=(0,e.WQX)(E.nX);profileForm;saving=(0,e.vPA)(!1);loading=(0,e.vPA)(!0);darkMode=this.themeService.darkMode;genderOptions=[{value:"male",label:"Male"},{value:"female",label:"Female"},{value:"non-binary",label:"Non-binary"},{value:"genderqueer",label:"Genderqueer"},{value:"transgender",label:"Transgender"},{value:"prefer-not-to-say",label:"Prefer not to say"},{value:"other",label:"Other"}];ngOnInit(){this.initForm(),this.loadCurrentProfile()}initForm(){this.profileForm=this.fb.group({gender:[""],pronouns:[""],bio:["",[a.k0.maxLength(500)]],online_links:this.fb.array([])})}get onlineLinks(){return this.profileForm.get("online_links")}addLink(){this.onlineLinks.push(this.fb.group({platform:["",a.k0.required],url:["",[a.k0.required,a.k0.pattern(/^https?:\/\/[^\s$.?#].[^\s]*$/)]]}))}removeLink(n){this.onlineLinks.removeAt(n)}loadCurrentProfile(){this.wallet.address$.pipe((0,x.s)(1)).subscribe(n=>{if(!n)return this.snackBar.open("No wallet connected","Close",{duration:4e3}),void this.loading.set(!1);this.apiService.getProfile(n,"profile").subscribe({next:t=>{const r=t.attributes||{};this.profileForm.patchValue({gender:r.gender?.code||"",pronouns:r.pronouns||"",bio:r.bio||""}),t.online_links&&"object"==typeof t.online_links&&Object.entries(t.online_links).forEach(([d,s])=>{this.onlineLinks.push(this.fb.group({platform:[d],url:[s]}))}),this.loading.set(!1)},error:t=>{console.error("Failed to load profile for editing:",t),this.snackBar.open("Could not load current profile data","Close",{duration:5e3}),this.loading.set(!1)}})})}onSubmit(){if(this.profileForm.invalid)return this.profileForm.markAllAsTouched(),void this.snackBar.open("Please fill required fields correctly","Close",{duration:4e3});this.saving.set(!0),this.wallet.address$.pipe((0,x.s)(1)).subscribe(n=>{if(!n)return this.saving.set(!1),void this.snackBar.open("No wallet connected","Close",{duration:3e3});const r=this.onlineLinks.value.reduce((s,f)=>(f.platform&&f.url&&(s[f.platform.trim()]=f.url.trim()),s),{});this.apiService.createProfile({owner:n,contexts:{profile:{attributes:{gender:this.profileForm.value.gender||void 0,pronouns:this.profileForm.value.pronouns||void 0,bio:this.profileForm.value.bio||void 0},online_links:r}},credentials:[]}).subscribe({next:s=>{this.saving.set(!1),this.snackBar.open("Profile updated successfully!","Close",{duration:4e3}),this.router.navigate(["../overview"],{relativeTo:this.activatedRoute})},error:s=>{console.error("Profile update failed:",s),this.saving.set(!1),this.snackBar.open("Failed to update profile. Try again.","Close",{duration:6e3})}})})}cancel(){this.router.navigate(["../overview"],{relativeTo:this.activatedRoute})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=e.VBU({type:o,selectors:[["app-profile-edit"]],standalone:!0,features:[e.aNF],decls:12,vars:8,consts:[[1,"edit-profile-container"],[1,"page-header"],[1,"subtitle"],["appearance","outlined",1,"edit-card","glass-card"],["class","connection-state",4,"ngIf"],[4,"ngIf"],[1,"connection-state"],["diameter","48"],[1,"state-message"],[1,"muted"],[1,"profile-edit-form",3,"ngSubmit","formGroup"],[1,"form-grid"],["appearance","outline",1,"form-field"],["formControlName","gender"],["value",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","pronouns","placeholder","they/them, she/her, he/him, ze/zir..."],["appearance","outline",1,"form-field","full-width"],["matInput","","formControlName","bio","rows","5","maxlength","500","placeholder","Share a bit about yourself, your interests, or what you do..."],["align","end"],[1,"links-section"],[1,"section-header"],["mat-mini-fab","","color","primary","type","button","matTooltip","Add new link","aria-label","Add link",3,"click"],["formArrayName","online_links",1,"links-container"],["class","link-item glass-item",3,"formGroupName",4,"ngFor","ngForOf"],["class","empty-links",4,"ngIf"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",1,"save-btn",3,"disabled"],["diameter","20",4,"ngIf"],["mat-stroked-button","","type","button",3,"click"],[3,"value"],[1,"link-item","glass-item",3,"formGroupName"],["appearance","outline",1,"platform"],["matInput","","formControlName","platform","placeholder","Twitter / X, GitHub, LinkedIn, Website..."],["appearance","outline",1,"url"],["matInput","","formControlName","url","placeholder","https://twitter.com/yourhandle"],["matPrefix",""],["mat-icon-button","","color","warn","type","button","matTooltip","Remove this link",3,"click"],[1,"empty-links"],[1,"empty-icon"],["diameter","20"]],template:function(t,r){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"h1"),e.EFF(3,"Edit Profile"),e.k0s(),e.j41(4,"p",2),e.EFF(5,"Update how others see you in the ecosystem"),e.k0s()(),e.j41(6,"mat-card",3)(7,"mat-card-content"),e.DNE(8,y,7,0,"div",4),e.nI1(9,"async"),e.DNE(10,L,41,9,"ng-container",5),e.nI1(11,"async"),e.k0s()()()),2&t&&(e.AVh("dark",r.darkMode()),e.R7$(8),e.Y8G("ngIf",!e.bMT(9,4,r.wallet.address$)),e.R7$(2),e.Y8G("ngIf",e.bMT(11,6,r.wallet.address$)))},dependencies:[m.MD,m.Sq,m.bT,m.Jj,a.X1,a.qT,a.me,a.BC,a.cb,a.tU,a.j4,a.JD,a.$R,a.v8,_.Hu,_.RN,_.m2,c.RG,c.rl,c.nJ,c.MV,c.JW,g.fS,g.fg,b.Ve,b.VO,F.wT,p.Hl,p.$z,p.iY,p.$0,v.m_,v.An,h.D6,h.LG,k._T,P.uc,P.oV],styles:["[_nghost-%COMP%]{display:block}.edit-profile-container[_ngcontent-%COMP%]{padding:clamp(24px,4vw,48px) clamp(16px,5vw,64px);max-width:900px;margin:0 auto;transition:background .5s ease}.edit-profile-container.dark[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#0f0f1a,#0a0a14);color:#e2e8f0}.page-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:clamp(32px,5vw,56px)}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:clamp(2.2rem,5vw,3.2rem);font-weight:800;background:linear-gradient(135deg,#6366f1,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:0 0 8px}.subtitle[_ngcontent-%COMP%]{font-size:1.1rem;color:#94a3b8;font-weight:400}.edit-card[_ngcontent-%COMP%]{border-radius:24px;background:var(--card-bg, rgba(255, 255, 255, .78));-webkit-backdrop-filter:blur(16px) saturate(180%);backdrop-filter:blur(16px) saturate(180%);border:1px solid var(--card-border, rgba(226, 232, 240, .4));overflow:hidden;transition:all .4s ease}.edit-profile-container.dark[_ngcontent-%COMP%]   .edit-card[_ngcontent-%COMP%]{background:#1e293b7a;border-color:#64748b4d;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}.connection-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:420px;gap:24px;color:#94a3b8;text-align:center}.state-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:var(--text-primary)}.profile-edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:32px;padding:24px}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:24px}.form-field.full-width[_ngcontent-%COMP%]{grid-column:1/-1}@media (max-width: 720px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600;color:var(--text-primary)}.links-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.link-item[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-start;flex-wrap:wrap;padding:16px;border-radius:16px;background:var(--row-bg, rgba(0, 0, 0, .03));transition:all .25s ease}.edit-profile-container.dark[_ngcontent-%COMP%]   .link-item[_ngcontent-%COMP%]{background:#ffffff0d}.link-item[_ngcontent-%COMP%]:hover{background:var(--row-hover, rgba(99, 102, 241, .08))}.platform[_ngcontent-%COMP%]{flex:1 1 180px;min-width:140px}.url[_ngcontent-%COMP%]{flex:3 1 340px;min-width:240px}.empty-links[_ngcontent-%COMP%]{text-align:center;padding:48px 24px;color:#94a3b8;background:var(--row-bg, rgba(0, 0, 0, .02));border-radius:16px}.empty-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:12px;opacity:.7}.form-actions[_ngcontent-%COMP%]{display:flex;gap:16px;justify-content:flex-end;margin-top:24px;padding-top:24px;border-top:1px solid var(--divider, rgba(226, 232, 240, .3))}.save-btn[_ngcontent-%COMP%]{min-width:160px}@media (max-width: 480px){.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.save-btn[_ngcontent-%COMP%]{width:100%}}"]})}return o})()}}]);